<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>_TITLE_</title>

    <style>
        html {
            height: 100%
        }

        body {
            height: 100%
        }

        #map {
            height: 100%;
            width: 100%
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <script language="javascript" type="text/javascript">
        var _Map;
        var _aryPoint = [];
        var _Polygon;

        function initMap() {
            var cenLatLon = new google.maps.LatLng(_LAT_, _LON_);
            var opts = {
                zoom: 20,               // 地図の縮尺地
                center: cenLatLon,      // 地図の中心座標
                mapTypeId: 'satellite'  // 地図の種類
            };
            _Map = new google.maps.Map(document.getElementById("map"), opts);

            try {
                chrome.webview.postMessage('Completed :initMap');
            }
            catch (error) {
                console.error(`'chrome.webview' is undefined.(${error.message})`)
            }
        }

        function addMarker(lat_, lon_, imgName_) {
            //alert("addMarker");
            var title_img = imgName_.toString()      // 変換なしで使うと、型：undefined判定される;
            var posLatLon = new google.maps.LatLng(lat_, lon_);
            var opts = {
                position: posLatLon,
                map: map,
                //clickable: false,
                //draggable: false,
                //flat:false,
                title: title_img
            };

            var marker = new google.maps.Marker(opts);
            marker.setMap(_Map);
            return "OK";
        }

        // ポイント登録
        function setPoint(lat_, lon_) {
            var point = {};
            point["lat"] = lat_;
            point["lng"] = lon_;
            _aryPoint.push(point);

            //addMarker(lat_, lon_);
            return "OK";
        }

        // ポリゴン設定
        function addPolygon() {
            //alert("_aryPoint.length：" + _aryPoint.length.toString());
            _Polygon = new google.maps.Polygon({
                paths: _aryPoint,
                strokeColor: '#FFD700',
                strokeOpacity: 1.0,
                strokeWeight: 2,
                fillColor: '#FFD700',
                fillOpacity: 0.10
            });

            _Polygon.setMap(_Map);
            return "OK";
        }

        // ポイント登録
        function chkInsideArea(lat_, lon_) {
            var posLatLon = new google.maps.LatLng(lat_, lon_);
            var res = google.maps.geometry.poly.containsLocation(posLatLon, _Polygon);

            return res;
        }
    </script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?key=_API_KEY_&language=ja&callback=initMap">
    </script>
</body>

</html>